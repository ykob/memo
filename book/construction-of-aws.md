# 図解まるわかり AWSのしくみ

https://www.amazon.co.jp/dp/B09ZTH1FJW/

## 第1章 AWSを使う

- クラウドコンピューティングのメガベンダー
  - Amazon (AWS)
  - Microsoft (Azure)
  - Google (Google Cloud Platform)
- AWSのユーザーが必要なITリソースを選択して使用する
- AWSのクラウド製品概要
  - コンピューティング（サーバー）... EC2, ECS
  - ストレージ ... S3, EBS
  - データベース ... RDS, DynamoDB
  - ネットワーク ... VPC
  - エンドユーザーコンピューティング(クライアント) ... WorkSpaces, WorkLink
- 複雑な最新技術を比較的容易に利用できる
- Cloud Watch ... AWSで利用するITリソースの運用監視を行うサービス

## 第2章 クラウド利用の基本 -事前に検討すべきこと-

- オンプレミス ... 自社でITリソースを保有して管理する。
- オンプレミスでの場合と同等のシステム構成をクラウド上でどう実現するかを事前にドキュメント化する。
  - 一般的には構成設計、論理構成図などに整理する。
  - システムの設置場所、本拠地はどこか
  - ネットワークやサーバー、ストレージはどのような構成にするか
- AWSのリージョン ... どこの地域に設置されているITリソースを使うか
- アベイラビリティ・ゾーン（Availability Zone: AZ） ... リージョンごとに配備されている
  - 日本国内のAZは東京、大阪の2つのリージョンがあり、その中にAZ-A、AZ-Cのように論理的な別のデータセンターがある
- AWSのサーバーは仮想サーバー
- 1つ1つの仮想サーバーは「インスタンス」と呼ぶ
- [AWS Well-Architected](https://docs.aws.amazon.com/ja_jp/wellarchitected/latest/framework/welcome.html) フレームワーク ... AWSが推奨する基本的かつ重要な事柄のチェックを行える。

## 第3章 Amazon EC2 を使う -クラウドの仮想サーバーを使うために-

- インスタンスタイプ ... さまざまな仮想サーバーの種類のこと
  - インスタンスタイプはそれぞれがサーバであり、CPU、メモリ、ストレージなどから構成されている
- インスタンスファミリー ... インスタンスタイプの上位概念
  - 汎用、コンピューティング最適化、メモリ最適化、ストレージ最適化、高速コンピューティング、のように整理されている
- スケーリング ... 仮想サーバーの性能や台数を変更していくこと
  - スケールアップとスケールダウン ... インスタンスのCPUコア数やメモリ容量などのスペックを上げる/下げること
  - スケールアウトとスケールイン ... インスタンスの数量を増やすこと/減らすこと
- EC2 Auto Scaling ... 自動的にスケールアウトやスケールインを行うサービス
- EC2 で利用できるOS ... Linux、Windows Server、macOS、Deep Learning専用他
- 各種サービスの設定は[AWSマネジメントコンソール](https://aws.amazon.com/jp/console/)で行う
- AMI (Amazon Machine Image) ... インスタンスがどのようなソフトウェアで構成されているかを示すテンプレート
- EBS (Amazon Elastic Block Store) ... EC2と組み合わせて利用するストレージ
  - EBSにOSやデータなどが格納されていくので、EC2を作成する際には必ずEBSが利用される
  - PCのように同じ筐体の中で直接接続されているのではなく、ネットワークで接続されている
- Webサーバー ... 私達が日常的に観ているWebサイト他を提供するサーバー
  - Webサーバーの最小ソフトウェア構成例
    - サーバOS ... Linux
    - Webサーバー機能 ... ApatchやNginxなど
    - Webページのもとファイル ... HTML/CSSなどページを構成するファイル
- サーバーを作成したら終わりではない、システムの動作や日常的な運用を支えるしくみに関連する設定作業のほうが大変
  - ネットワーク設定
  - セキュリティ設定
  - IAMなどのユーザー管理
- 無料利用枠を考慮する場合、インスタンスの設定で注意すべき項目がある
  - 自動割り当てパブリックIP、キャパシティの予約、テナンシー
- セキュリティグループの設定でSSH接続のためのキーペアが作成できる
- Webサーバー機能のインストールが必要
  - Apatchのインストールを、インスタンスに接続してAmazon Linux 2のコマンドラインからコマンドを入力して行う
  - Apatchを起動する
- 固定IPアドレスを取得する。AWSでは固定IPのことをElastic IPアドレスと呼ぶ。
- 実際にEC2を利用しているのは中小規模以上のWebサービスを提供する場合が多い。
- LightSail ... レンタルサーバーに近く、比較的簡単にWebサーバーを構築できるサービス

## 第4章 Amazon S3を使う -クラウドらしいストレージサービス-

- S3 (Simple Storage Service) ... 小～大規模のスケーラビリティで高可用性・低コストを実現するオブジェクトストレージのサービス
  - インターネットからのアクセスが可能で、ストレージとしてだけでなく、静的なWebページとしても利用ができる
  - S3は、バックアップや大容量ファイルの保管で利用されることが多い。
- クロスリージョンレプリケーション ... S3をリージョン間で複製する機能。あるリージョンで大規模災害などが発生しても、別のリージョンに複製されたデータから復旧できればビジネスは継続できる。
- ストレージクラス ... 標準、インテリジェント、低頻度、他から選択が出来る
- S3をファイル共有サービスとして利用することも可能
- S3でファイルを共有するためには**バケット**を作成する必要がある
- S3は実際にはオンプレミスのバックアップとして利用されることが多い

## 第5章 クラウドを支える技術 -クラウド事業者の視点から-

- AWSはIaaSやPaaSに位置づけられる。
  - IaaS (Infrastructure as a Service) ... クラウド事業者がサーバーやネットワーク機器、OSを提供するサービス
  - PaaS (Platform as a Service) ... IaaSに加え、データベースなどのミドルウェアとアプリケーションの開発環境が加わる
  - SaaS (Software as a Service) ... アプリケーションとその機能を利用するサービス
- VPC (Virtual Private Cloud) ... プライベートクラウドをパブリッククラウド上で実現する仮想ネットワークサービス
  - VPCはクラウド上にデータセンターに相当する仮想空間を作り、その中にサーバーやストレージ(IaaS)を配置したり、VPCの中でPaaSを利用したりできる
  - VPCでクラウド事業者のデータセンター内に構築された仮想のネットワークと自社のネットワークはVPNや専用線などで接続される
  - VPC内の仮想サーバーやネットワーク機器には、プライベートなIPアドレスを割り当てることができるようになっている
- クラウド事業者のデータセンターにはコントローラーと呼ばれるサーバーがあり、サービスを一元的に管理・運用している
  - 仮想サーバー、ネットワーク、ストレージの管理
  - リソース配分（ユーザーの割り当て）
  - ユーザー認証
  - 稼働状況の管理
- [OpenStack](https://www.openstack.org/) ... IaaS向けの基盤ソフト。大きくはクラウド内部の基盤と外部向けのサービスの2つから構成されている。
- [Cloud Foundry](https://www.cloudfoundry.org/) ... Pass向けの基盤ソフト。PythonやRubyなどの開発言語、開発フレームワーク、データベースなども使えるようになっている。
- サーバーの仮想化技術のトレンド
  - これまで仮想化シーンをリードしてきた製品 ... VMWare vSphere Hypervisor, Hyper-V, Xen, KVMなど。ハイパーバイザー型と呼ばれる
    - ハイパーバイザー型は物理的なサーバー上での仮想化ソフトとして、その上にLinuxやWindowsなどのゲストOSを載せて動かす
  - 今後の主流になると言われているのが**コンテナ型** ... Docker
    - コンテナ型の構成では、ゲストOSではホストOSのカーネル機能を共有することで軽量化している
    - コンテナ内のゲストOSには必要最小限のライブラリしか含まないことから、CPUやメモリへの負荷が小さく高速な処理を実現でき、アプリケーションの起動がスムーズになり、リソース効率がよくなる
    - 仮想サーバーのパッケージを小さく軽量化できる
    - 各サーバーに環境があれば、コンテナ単位で別のサーバーに移行することもできる
    - サービスや機能ごとにコンテナを作成して、それぞれの仮想サーバーを構築することも可能
    - 異なるサーバー間に存在するコンテナの関係性を管理するには**オーケストレーション**が必要となる
- クラウドのストレージ
  - ファイルストレージ ... データをファイルごとに管理する。NASなどで利用されている
  - ブロック・ストレージ ... データを一定の大きさ（ブロック）に区切って管理するので高速な通信を可能にする。主にSANで利用されている
  - オブジェクトストレージ ... データをファイルやブロック単位ではなく、オブジェクトという単位で扱う。ストレージプールと呼ばれる入れ物にオブジェクトが作成され、固有のIDとメタデータで管理する
- オブジェクトストレージがファイルストレージよりも優れている点
  - 格納場所の変更やスケールアウトがしやすい
  - プロトコルがHTTPSであることから、データセンターをまたいでもスムーズに対応できる
- VLAN (Virtual LAN: 仮想LAN) ... 1つの物理的なLANを複数の仮想LANに分割できる。ネットワーク機器の物理構成の変更をしない前提であれば有効な技術
- SDN (Software-Defined Networking) ... ソフトウェアでネットワークの仮想化を実現する技術
  - 機器と経路を制御する機能とデータを転送する機能を分ける
  - 上記の制御機能をソフトウェアで集中管理する
## GraphQL とは

GraphQL は、データクエリ言語および実行エンジンであり、クライアントとサーバ間の効率的なデータ通信を支援するための技術である。

- GraphQL は、クライアントが必要なデータのみを要求することができるよう設計されている
- REST API のように複数のエンドポイントを使用する代わりに、GraphQL では単一のエンドポイントを使用する
- クライアントが必要なフィールドやリレーションシップを明示的に指定できるため、サーバ側は必要なデータのみを提供することができる。これにより、効率的なデータ転送と高速なクエリの実行が可能となる。
- GraphQL はタイプシステムを持っており、データの形式や関係性を定義できる。これにより、データの構造やバリデーションが簡単に行える他、自動的なドキュメント生成や型安全性の向上も実現される。
- GraphQL は複数のリクエストを 1 つのバッチとしてまとめて実行できるため、ネットワークオーバーヘッドを削減できる。

## 用語

| 用語              | 意味                            |
| :---------------- | :------------------------------ |
| スキーマ Schema   | クエリ、型などの定義を行うもの  |
| リゾルバ Resolver | 実際のデータ操作を行うもの      |
| SDL               | Schema Definition Language の略 |

## GraphQL Schema-First と Code-First

Schema-First と Code-First、いずれも GraphQL 開発の手法の名称である。

### Schema-First

Schema-First アプローチでは、まず GraphQL スキーマを定義し、それに基づいてリゾルバ（データの取得と操作を処理する関数）を実装する。  
スキーマは通常、GraphQL のタイプやクエリ、ミューテーション、サブスクリプションなどを記述する。  
このアプローチの主な利点として、API の形状が明確に定義されるため、クライアントとサーバ間の契約が明確になり、コミュニケーションやバージョン管理がしやすくなる点が挙げられる。

- 契約が明確: スキーマによって API の形状が明確に定義され、クライアントとのコミュニケーションが容易になる。
- ドキュメント生成: スキーマから自動的にドキュメントが生成されることが多い。
- クライアント側の型生成: スキーマからクライアント側の型が生成され、型安全性が向上する。

### Code-First

まずプログラムコード（一般的にはプレーンなクラスや関数）を記述し、それに基づいて GraphQL スキーマが自動的に生成される。  
スキーマがコードから生成されるため、コードとスキーマが一貫して保たれる利点がある。  
一部のフレームワークでは、デコレータやアノテーションを使用してスキーマの定義を行う。

- プログラム的な柔軟性: コードを使用してスキーマを生成するため、柔軟なカスタマイズや高度なロジックが可能になる。
- 既存コードの統合: 既存のクラスやデータモデルからスキーマを生成しやすい。
- コードとスキーマの一貫性: コードとスキーマが同じリポジトリ内に存在し、一貫性が保たれる。

### どちらが優れているか

どちらが優れているかは、プロジェクトの要件に依存する。  
もし API の形状が重要であり、クライアントとの契約を明確にしたい場合は Schema-First が適しているかもしれない。  
一方、柔軟なロジックや既存のコードとの統合が主要な要件である場合は、Code-First が有益かもしれない。

最終的には、プロジェクトのニーズ、チームのスキルセット、開発スピードなどを考慮して、どちらのアプローチが最適かを判断することが重要となる。

## 参考リンク

- [Schema-First vs Code-Only GraphQL - Apollo GraphQL Blog](https://www.apollographql.com/blog/backend/architecture/schema-first-vs-code-only-graphql/)

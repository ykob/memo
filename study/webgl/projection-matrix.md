# プロジェクション座標変換

通常の3Dアプリケーションにはカメラがあるが、WebGLのAPI自体にあるのは行列だけであり、カメラオブジェクトに該当するものはない。 
WebGLでカメラを表現するためには4×4の行列を使用する必要がある。  

カメラを動かすと、それに併せてオブジェクトの表示を更新しなければならない。  
それには新しい視点に対応するように各頂点に規則的な座標変換を適用する必要がある。  
その際に重要なのが、カメラの移動後にオブジェクトの法線と光線の向きの一貫性を維持することである。つまり、頂点(位置)と法線(向き)それぞれの変換の仕方を理解する必要がある。

## 頂点変換

WebGLのシーンのオブジェクトには、スクリーン上に表示される前に様々な座標変換が適用される。  
それぞれの変換は4×4行列の形式で表現される。  
3次元ベクトルで表現される位置や向きに4×4行列を掛け合わせるには、タプルに一次元を追加して濃度を拡張すればよい。  
つまり、それぞれの頂点座標に同次座標と呼ばれる4番目の要素を追加する。

### 同次座標

同次座標を利用することで、アフィン変換（回転、拡大縮小、せん断変形、平行移動など）と4×4行列を使用した投影変換を表現できる。

同次座標系では頂点は `(x, y, z, w)` という4つの要素を持つ。  
最初の3つはユークリッド空間での頂点座標で、4番目が投影養素となる。  
4要素のタプル `(x, y, z, w)` を使用することで投影空間を定義することが出来る。

同次座標は各座標を `w` で割ることで非同次座標（旧来のユークリッド座標）に簡単に変換できる。  
逆にユークリッド空間から投影空間に変換するには `w` に1を追加すればよい。  
また `w` が `0` の同次座標は無限遠の点を表す。

頂点シェーダーにおいて、位置ベクトルの変換で頻繁に用いられる記述は以下のようになる。

```
vec4 mvPosition = ModelViewMatrix * vec4(position, 1.0);
```

## 透視投影 (Perspective Projection)

## 平行投影 (Parallel Projection)